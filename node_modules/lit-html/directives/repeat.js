import{noChange as e}from"../lit-html.js";import{directive as s,Directive as t,PartType as r}from"../directive.js";import{getComittedValue as l,setChildPartValue as i,insertPart as o,removePart as n,setComittedValue as f}from"../directive-helpers.js";
/**
 * @license
 * Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */
const u=(e,s,t)=>{const r=new Map;for(let l=s;l<=t;l++)r.set(e[l],l);return r},c=s(class extends t{constructor(e){if(super(e),e.type!==r.CHILD)throw Error("repeat can only be used in text bindings")}At(e,s,t){let r;void 0===t?t=s:void 0!==s&&(r=s);const l=[],i=[];let o=0;for(const s of e)l[o]=r?r(s,o):o,i[o]=t(s,o),o++;return{values:i,keys:l}}render(e,s,t){return this.At(e,s,t).values}update(s,[t,r,c]){const d=l(s),{values:h,keys:p}=this.At(t,r,c);if(!d)return this.itemKeys=p,h;const a=this.itemKeys??(this.itemKeys=[]),v=[];let m,y,j=0,x=d.length-1,b=0,g=h.length-1;for(;j<=x&&b<=g;)if(null===d[j])j++;else if(null===d[x])x--;else if(a[j]===p[b])v[b]=i(d[j],h[b]),j++,b++;else if(a[x]===p[g])v[g]=i(d[x],h[g]),x--,g--;else if(a[j]===p[g])v[g]=i(d[j],h[g]),o(s,v[g+1],d[j]),j++,g--;else if(a[x]===p[b])v[b]=i(d[x],h[b]),o(s,d[j],d[x]),x--,b++;else if(void 0===m&&(m=u(p,b,g),y=u(a,j,x)),m.has(a[j]))if(m.has(a[x])){const e=y.get(p[b]),t=void 0!==e?d[e]:null;if(null===t){const e=o(s,d[j]);i(e,h[b]),v[b]=e}else v[b]=i(t,h[b]),o(s,d[j],t),d[e]=null;b++}else n(d[x]),x--;else n(d[j]),j++;for(;b<=g;){const e=o(s,v[g+1]);i(e,h[b]),v[b++]=e}for(;j<=x;){const e=d[j++];null!==e&&n(e)}return this.itemKeys=p,f(s,v),e}});export{c as repeat};
//# sourceMappingURL=repeat.js.map
